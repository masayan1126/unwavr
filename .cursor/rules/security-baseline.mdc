---
alwaysApply: true
---

# セキュリティ・ベースライン

- 機密情報
  - APIキー、トークン、パスワードはコードに直書きしない。環境変数に置く。
  - `.env*` は Git 管理外（.gitignore）にする。

- 認証/認可
  - 最小権限の原則を適用。不要な権限は付与しない。
  - パスワードのハッシュ化は安全なライブラリ（例: bcrypt）。

- 入力検証
  - ユーザー入力は必ずバリデーションとエスケープ。
  - API/DB にはパラメータ化クエリを使用。

- 通信
  - 外部通信は HTTPS/TLS を使用。
  - 必要に応じてセキュアヘッダ（CSP, HSTS 等）を設定。

- 依存関係
  - 既知脆弱性のあるバージョンを避ける。不要な依存は削除。

- ログ/監視
  - 機密情報をログに出力しない。ログレベルを適切に設定。

